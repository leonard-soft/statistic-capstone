<!DOCTYPE html>
<html>
<head>
    <title>Charge csv</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="sidebar">
    <h2 class="section-title">Content</h2>
    <div class="menu">
        <a onclick="showContent('variables')" style="cursor:pointer"> All Variables</a>
        <a onclick="showContent('tabla')" style="cursor:pointer;">Tabla de datos</a><br>
        <a onclick="showContent('grafico')" style="cursor:pointer;">Gráfico</a><br>
        <a onclick="showContent('otro')" style="cursor:pointer;">Otro contenido</a>
        <a onclick="showContent('estadisticas')" style="cursor:pointer;">Estadísticas</a><br>
    </div>
</div>

<div class="content">
    <div id="tabla" style="display:none;">
        {% if Columns and Data %}
            <h2>Tabla de datos</h2>
            <table border="1">
                <tr>
                    {% for col in Columns %}
                        <th>{{ col }}</th>
                    {% endfor %}
                </tr>
                {% for fila in Data %}
                    <tr>
                        {% for celda in fila %}
                            <td>{{ celda }}</td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <p>No se encontraron datos.</p>
        {% endif %}
    </div>

    <div id="variables" class="container my-4">
        <h2 class="text-center mb-4 position-relative d-inline-block mx-auto pb-2 border-bottom border-3 border-primary" style="font-family: 'Segoe UI', sans-serif; font-weight: 600;">
            All Variables
        </h2>

        {% if Columns %}
            <div class="table-responsive d-flex justify-content-center">
                <table class="table table-bordered table-hover table-striped align-middle w-auto">
                    <thead class="table-primary text-center">
                    <tr>
                        <th>Variable</th>
                        <th>Tipo</th>
                        <th>Subtipo</th>
                        <th>Descripción</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for col in Columns %}
                        <tr>
                            <td>{{ col }}</td>
                            <td>
                                {% if col == "hours_coding" or col == "coffee_intake_mg" or col == "sleep_hours" or col == "ai_usage_hours" or col == "cognitive_load" %}
                                    Cuantitativa
                                {% elif col == "distractions" or col == "task_success" %}
                                    Cualitativa
                                {% elif col == "commits" or col == "bugs_reported" %}
                                    Cuantitativa
                                {% else %}
                                    Desconocido
                                {% endif %}
                            </td>
                            <td>
                                {% if col == "hours_coding" or col == "sleep_hours" or col == "ai_usage_hours" or col == "cognitive_load" %}
                                    Continua
                                {% elif col == "coffee_intake_mg" or col == "commits" or col == "bugs_reported" %}
                                    Discreta
                                {% elif col == "distractions" %}
                                    Nominal
                                {% elif col == "task_success" %}
                                    Ordinal
                                {% else %}
                                    Desconocido
                                {% endif %}
                            </td>
                            <td>
                                {% if col == "hours_coding" %}
                                    Horas diarias programando
                                {% elif col == "coffee_intake_mg" %}
                                    Miligramos de cafeína consumidos
                                {% elif col == "distractions" %}
                                    Fuente principal de distracción
                                {% elif col == "sleep_hours" %}
                                    Horas de sueño por noche
                                {% elif col == "commits" %}
                                    Número de commits diarios
                                {% elif col == "bugs_reported" %}
                                    Errores reportados por día
                                {% elif col == "ai_usage_hours" %}
                                    Horas de uso de herramientas de IA
                                {% elif col == "cognitive_load" %}
                                    Nivel de carga cognitiva
                                {% elif col == "task_success" %}
                                    Nivel de éxito en tareas asignadas
                                {% else %}
                                    Sin descripción
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <div class="alert alert-warning text-center" role="alert">
                No se encontraron columnas en los datos.
            </div>
        {% endif %}
    </div>


    <div id="grafico" style="display:none;">
        <h2>Gráfico</h2>
        <canvas id="miGrafico" width="600" height="300"></canvas>
    </div>

    <div id="otro" style="display:none;">
        <h2>Otro contenido</h2>
        <p>Aquí puedes poner cualquier otro contenido.</p>
    </div>

    <div id="estadisticas" style="display:none;">
        <h2>Medidas de Tendencia Central y Dispersión</h2>
        {% if estadisticas %}
            <table border="1" style="width:100%; background:white; border-collapse: collapse;">
                <thead>
                <tr>
                    <th>Variable</th>
                    <th>Media</th>
                    <th>Mediana</th>
                    <th>Moda</th>
                    <th>Desv. Estándar</th>
                </tr>
                </thead>
                <tbody>
                {% for fila in estadisticas %}
                    <tr>
                        <td>{{ fila.0 }}</td>
                        <td>{{ fila.1 }}</td>
                        <td>{{ fila.2 }}</td>
                        <td>{{ fila.3 }}</td>
                        <td>{{ fila.4 }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No hay estadísticas disponibles.</p>
        {% endif %}
    </div>

</div>

<script>
    let myChart = null;

    function showContent(id) {
        const sections = ['variables', 'tabla', 'grafico', 'otro', 'estadisticas'];
        sections.forEach(sectionId => {
            document.getElementById(sectionId).style.display = sectionId === id ? 'block' : 'none';
        });

        if (id === 'grafico') {
            if (!myChart) {
                const ctx = document.getElementById('miGrafico').getContext('2d');
                myChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: {{ graphic_data.label|safe }},
                        datasets: [{
                            label: 'Valores',
                            data: {{ graphic_data.date|safe }},
                            backgroundColor: 'rgba(75, 192, 192, 0.5)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }
    }

    showContent('tabla');
</script>

</body>
</html>
